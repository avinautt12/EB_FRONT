<app-top-bar-usuarios></app-top-bar-usuarios>

<div class="usuarios-fullscreen">
    <div class="usuarios-header">
        <h2>Historial de Proyecciones</h2>
    </div>

    <div *ngIf="cargando" class="cargando-spinner">
        <div class="spinner"></div>
        <p>Cargando historial...</p>
    </div>

    <div *ngIf="!cargando && historial.length === 0" class="sin-datos">
        <p>No tienes proyecciones registradas.</p>
    </div>

    <table *ngIf="!cargando && historial.length > 0" class="tabla-usuarios">
        <thead>
            <tr>
                <th>Fecha en que se realizó la proyección</th>
                <th>Clave</th>
                <th class="descripcion">Descripción</th>
                <th>Modelo</th>
                <th class="quincena">1ra Quincena Oct</th>
                <th class="quincena">2da Quincena Oct</th>
                <th class="quincena">1ra Quincena Nov</th>
                <th class="quincena">2da Quincena Nov</th>
                <th class="quincena">1ra Quincena Dic</th>
                <th class="quincena">2da Quincena Dic</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of historial">
                <td>{{ formatearFechaUTC(item.fecha_registro) }}</td>
                <td>{{ item.clave_factura }}</td>
                <td class="descripcion">{{ item.descripcion }}</td>
                <td>{{ item.modelo }}</td>
                <td class="quincena">{{ item.q1_oct_2025 }}</td>
                <td class="quincena">{{ item.q2_oct_2025 }}</td>
                <td class="quincena">{{ item.q1_nov_2025 }}</td>
                <td class="quincena">{{ item.q2_nov_2025 }}</td>
                <td class="quincena">{{ item.q1_dic_2025 }}</td>
                <td class="quincena">{{ item.q2_dic_2025 }}</td>
                <td><strong>{{ getTotalPorItem(item) }}</strong></td>
            </tr>
        </tbody>
    </table>
</div>