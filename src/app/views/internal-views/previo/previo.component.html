<app-home-bar></app-home-bar>

<div class="monitor-container">
  <h2>Monitor Previo de Facturas</h2>

  <div class="acciones-monitor">
    <button class="btn" [routerLink]="['/monitor']"><i class="fas fa-folder-open"></i> Monitor</button>
    <button class="btn" [routerLink]="['/multimarcas']"><i class="fas fa-globe"></i> Multimarcas</button>
    <button class="btn" [routerLink]="['/distribuidores']"><i class="fas fa-file-alt"></i> Distribuidores</button>
    <button class="btn" [routerLink]="['/metas']"><i class="fas fa-bullseye"></i> Metas</button>
    <button class="btn" [routerLink]="['/inicio-caratulas']"><i class="fas fa-book"></i> Carátulas</button>
    <button class="btn btn-export" (click)="exportarAExcel()" [disabled]="cargando">
      <i class="fas fa-file-excel"></i> Exportar Excel
    </button>
  </div>

  <app-fecha-actualizacion></app-fecha-actualizacion>

  <div class="compliance-legend">
    <div class="legend-item">
      <div class="legend-color progress-excellent"></div>
      <span>Excelente (≥100%)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color progress-very-good"></div>
      <span>Muy Bueno (80-99%)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color progress-good"></div>
      <span>Bueno (60-79%)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color progress-warning"></div>
      <span>Regular (40-59%)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color progress-danger"></div>
      <span>Bajo ( < 40%)</span>
    </div>
  </div>

  <div *ngIf="cargando" class="cargando-spinner">
    <div class="spinner"></div>
    <p>Cargando...</p>
  </div>

  <div *ngIf="!cargando && clientesPaginados.length === 0 && integrales.length === 0" class="sin-datos">
    <p>No se pudieron cargar los datos o no hay clientes disponibles.</p>
  </div>

  <div class="tabla-scroll-wrapper" *ngIf="!cargando && (clientesPaginados.length > 0 || integrales.length > 0)">

    <div class="dummy-scroll-wrapper" #dummyScroll (scroll)="tablaContainer.scrollLeft = dummyScroll.scrollLeft">
      <div class="dummy-scroll-content" [style.width.px]="tabla.offsetWidth"></div>
    </div>

    <div class="tabla-contenedor" #tablaContainer (scroll)="dummyScroll.scrollLeft = tablaContainer.scrollLeft">

      <table class="tabla-previo" #tabla [class.single-row]="clientesFiltrados.length === 1">
        <thead>
          <tr>
            <th class="columna-fija fija-clave" style="min-width: 120px">
              <div class="filter-horizontal-container">
                <span class="filter-label">Clave</span>
                <app-filtro-previo tipo="clave" placeholder="Buscar clave..." [opciones]="opcionesClave"
                  [estaActivo]="esFiltroActivo('clave')" (aplicarFiltro)="aplicarFiltroClave($event)"
                  (limpiarFiltro)="limpiarFiltroClave()" (filtroClicked)="toggleFiltro('clave')">
                </app-filtro-previo>
              </div>
            </th>

            <th class="columna-fija fija-evac" style="min-width: 150px;">
              <div class="filter-horizontal-container">
                <span class="filter-label">EVAC</span>
                <app-filtro-previo tipo="evac" placeholder="Buscar EVAC..." [opciones]="opcionesEvac"
                  [estaActivo]="esFiltroActivo('evac')" (aplicarFiltro)="aplicarFiltroEvac($event)"
                  (limpiarFiltro)="limpiarFiltroEvac()" (filtroClicked)="toggleFiltro('evac')">
                </app-filtro-previo>
              </div>
            </th>

            <th class="columna-fija fija-cliente" style="min-width: 280px;">
              <div class="filter-horizontal-container">
                <span class="filter-label">Cliente</span>
                <app-filtro-previo tipo="cliente" placeholder="Buscar cliente..." [opciones]="opcionesCliente"
                  [estaActivo]="esFiltroActivo('cliente')" (aplicarFiltro)="aplicarFiltroCliente($event)"
                  (limpiarFiltro)="limpiarFiltroCliente()" (filtroClicked)="toggleFiltro('cliente')">
                </app-filtro-previo>
              </div>
            </th>

            <th style="min-width: 160px;">Acumulado Compra Anticipada</th>

            <th style="min-width: 140px;">
              <div class="filter-horizontal-container">
                <span class="filter-label">Elección NIVEL</span>
                <app-filtro-previo tipo="nivel" placeholder="Buscar nivel..." [opciones]="opcionesEleccionNivel"
                  [estaActivo]="esFiltroActivo('nivel')" (aplicarFiltro)="aplicarFiltroEleccionNivel($event)"
                  (limpiarFiltro)="limpiarFiltroEleccionNivel()" (filtroClicked)="toggleFiltro('nivel')">
                </app-filtro-previo>
              </div>
            </th>

            <th>
              <div class="filter-horizontal-container">
                <span class="filter-label">Cumplimiento de compra mínima inicial</span>
                <app-filtro-previo tipo="cumplimiento" placeholder="Buscar cumplimiento..."
                  [opciones]="opcionesCumplimiento" [estaActivo]="esFiltroActivo('cumplimiento')"
                  (aplicarFiltro)="aplicarFiltroCumplimiento($event)" (limpiarFiltro)="limpiarFiltroCumplimiento()"
                  (filtroClicked)="toggleFiltro('cumplimiento')">
                </app-filtro-previo>
              </div>
            </th>

            <th style="min-width: 130px;">Compra Mínima ANUAL</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 170px;"> Compra Mínima INICIAL</th>
            <th style="min-width: 150px;">Avance GLOBAL</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso BICICLETAS</th>
            <th style="min-width: 150px;">Avance GLOBAL BICICLETAS</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso JUL-AGO</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso SEPT-OCT</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso NOV-DIC</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso ENE-FEB</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso MAR-ABR</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso MAY-JUN</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso APPAREL, SYNCROS, VITTORIA</th>
            <th style="min-width: 150px;">Avance GLOBAL</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso JUL-AGO</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso SEPT-OCT</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>
            <th style="min-width: 150px;">Compromiso NOV-DIC</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso ENE-FEB App</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso MAR-ABR App</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 150px;">Compromiso MAY-JUN App</th>
            <th style="min-width: 150px;">Avance</th>
            <th style="min-width: 80px;">%</th>

            <th style="min-width: 130px;">SYNCROS Acumulado</th>
            <th style="min-width: 130px;">APPAREL Acumulado</th>
            <th style="min-width: 130px;">VITTORIA Acumulado</th>
            <th style="min-width: 130px;">BOLD Acumulado</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cliente of clientesPaginados">
            <td class="columna-fija fija-clave">{{ cliente.clave }}</td>
            <td class="columna-fija fija-evac">{{ cliente.evac }}</td>
            <td class="columna-fija fija-cliente nombre-cliente" (mouseenter)="mostrarTooltip($event, cliente)"
              (mouseleave)="ocultarTooltip()">
              {{ cliente.nombre_cliente }}
            </td>

            <td>{{ cliente.acumulado_anticipado | currency:'USD':'$':'1.2-2' }}</td>
            <td>{{ cliente.nivel }}</td>
            <td>{{ verificarCumplimientoCompraInicial(cliente) }}</td>
            <td class="td-number">{{ cliente.compra_minima_anual | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'anual')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'anual'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'anual'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'anual'))">
                {{ getPercentageValue(cliente, 'anual') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compra_minima_inicial | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ calcularAvanceGlobal(cliente) | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'inicial')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'inicial'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'inicial'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'inicial'))">
                {{ getPercentageValue(cliente, 'inicial') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_scott | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_global_scott | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'scott')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott'))">
                {{ getPercentageValue(cliente, 'scott') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_jul_ago | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_jul_ago | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'scott_jul_ago')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott_jul_ago'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott_jul_ago'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott_jul_ago'))">
                {{ getPercentageValue(cliente, 'scott_jul_ago') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_sep_oct | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_sep_oct | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'scott_sep_oct')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott_sep_oct'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott_sep_oct'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott_sep_oct'))">
                {{ getPercentageValue(cliente, 'scott_sep_oct') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_nov_dic | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_nov_dic | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'scott_nov_dic')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott_nov_dic'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott_nov_dic'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott_nov_dic'))">
                {{ getPercentageValue(cliente, 'scott_nov_dic') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_ene_feb | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_ene_feb | currency:'USD':'$':'1.2-2' }}</td>
            <td class="percentage-cell">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott_ene_feb'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott_ene_feb'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott_ene_feb'))">
                {{ getPercentageValue(cliente, 'scott_ene_feb') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_mar_abr | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_mar_abr | currency:'USD':'$':'1.2-2' }}</td>
            <td class="percentage-cell">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott_mar_abr'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott_mar_abr'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott_mar_abr'))">
                {{ getPercentageValue(cliente, 'scott_mar_abr') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_may_jun | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_may_jun | currency:'USD':'$':'1.2-2' }}</td>
            <td class="percentage-cell">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'scott_may_jun'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'scott_may_jun'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'scott_may_jun'))">
                {{ getPercentageValue(cliente, 'scott_may_jun') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_apparel_syncros_vittoria | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_global_apparel_syncros_vittoria | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'apparel_global')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_global'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_global'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_global'))">
                {{ getPercentageValue(cliente, 'apparel_global') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_jul_ago_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_jul_ago_app | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'apparel_jul_ago')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_jul_ago'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_jul_ago'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_jul_ago'))">
                {{ getPercentageValue(cliente, 'apparel_jul_ago') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_sep_oct_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_sep_oct_app | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'apparel_sep_oct')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_sep_oct'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_sep_oct'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_sep_oct'))">
                {{ getPercentageValue(cliente, 'apparel_sep_oct') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_nov_dic_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_nov_dic_app | currency:'USD':'$':'1.2-2' }}</td>

            <td class="percentage-cell" [attr.data-tooltip]="getTooltipText(cliente, 'apparel_nov_dic')">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_nov_dic'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_nov_dic'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_nov_dic'))">
                {{ getPercentageValue(cliente, 'apparel_nov_dic') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_ene_feb_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_ene_feb_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="percentage-cell">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_ene_feb'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_ene_feb'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_ene_feb'))">
                {{ getPercentageValue(cliente, 'apparel_ene_feb') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_mar_abr_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_mar_abr_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="percentage-cell">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_mar_abr'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_mar_abr'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_mar_abr'))">
                {{ getPercentageValue(cliente, 'apparel_mar_abr') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.compromiso_may_jun_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.avance_may_jun_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="percentage-cell">
              <div class="progress-bar" [ngClass]="getProgressClass(getPercentageValue(cliente, 'apparel_may_jun'))"
                [style.width.%]="Math.min(getPercentageValue(cliente, 'apparel_may_jun'), 100)"></div>
              <span class="progress-text" [ngClass]="getTextClass(getPercentageValue(cliente, 'apparel_may_jun'))">
                {{ getPercentageValue(cliente, 'apparel_may_jun') | number:'1.0-0' }}%
              </span>
            </td>

            <td class="td-number">{{ cliente.acumulado_syncros | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.acumulado_apparel | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.acumulado_vittoria | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ cliente.acumulado_bold | currency:'USD':'$':'1.2-2' }}</td>
          </tr>

          <div *ngIf="mostrarIntegrales">
            <tr *ngIf="integrales.length > 0" class="separador-integral">
              <td colspan="57">INTEGRALES</td>
            </tr>

            <tr *ngFor="let integral of integrales" class="fila-integral">
              <td class="columna-fija fija-clave">{{ integral.clave }}</td>
              <td class="columna-fija fija-evac">{{ integral.evac }}</td>
              <td class="columna-fija fija-cliente">{{ integral.nombre_cliente }}</td>

              <td class="td-number">{{ integral.acumulado_anticipado | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ integral.nivel }}</td>
              <td>{{ verificarCumplimientoCompraInicial(integral) }}</td>
              <td class="td-number">{{ integral.compra_minima_anual | currency:'USD':'$':'1.2-2' }}</td>

              <td>{{ calculoPorcentajeCompraAnual(integral) }}</td>

              <td class="td-number">{{ integral.compra_minima_inicial | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_global | currency:'USD':'$':'1.2-2' }}</td>

              <td>{{ calculoPorcentajeCompraInicial(integral) }}</td>

              <td class="td-number">{{ integral.compromiso_scott | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_global_scott | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_global_scott || 0) / (integral.compromiso_scott || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_jul_ago| currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_jul_ago | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_jul_ago || 0) / (integral.compromiso_jul_ago || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_sep_oct | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_sep_oct | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_sep_oct || 0) / (integral.compromiso_sep_oct || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_nov_dic | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_nov_dic | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_nov_dic || 0) / (integral.compromiso_nov_dic || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_ene_feb | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_ene_feb | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_ene_feb || 0) / (integral.compromiso_ene_feb || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_mar_abr | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_mar_abr | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_mar_abr || 0) / (integral.compromiso_mar_abr || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_may_jun | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_may_jun | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_may_jun || 0) / (integral.compromiso_may_jun || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_apparel_syncros_vittoria | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ (integral.avance_global_apparel_syncros_vittoria) | currency:'USD':'$':'1.2-2' }}
              </td>
              <td>{{ calculoPorcentajeAvanceSynAppVit(integral) }}</td>

              <td class="td-number">{{ integral.compromiso_jul_ago_app | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_jul_ago_app | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_jul_ago_app || 0) / (integral.compromiso_jul_ago_app || 1) | percent:'1.0-0' }}
              </td>

              <td class="td-number">{{ integral.compromiso_sep_oct_app | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_sep_oct_app | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_sep_oct_app || 0) / (integral.compromiso_sep_oct_app || 1) | percent:'1.0-0' }}
              </td>

              <td class="td-number">{{ integral.compromiso_nov_dic_app | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_nov_dic_app | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_nov_dic_app || 0) / (integral.compromiso_nov_dic_app || 1) | percent:'1.0-0' }}
              </td>

              <td class="td-number">{{ integral.compromiso_ene_feb_app | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_ene_feb_app | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_ene_feb_app || 0) / (integral.compromiso_ene_feb_app || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_mar_abr_app | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_mar_abr_app | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_mar_abr_app || 0) / (integral.compromiso_mar_abr_app || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.compromiso_may_jun_app | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.avance_may_jun_app | currency:'USD':'$':'1.2-2' }}</td>
              <td>{{ (integral.avance_may_jun_app || 0) / (integral.compromiso_may_jun_app || 1) | percent:'1.0-0' }}</td>

              <td class="td-number">{{ integral.acumulado_syncros | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.acumulado_apparel | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.acumulado_vittoria | currency:'USD':'$':'1.2-2' }}</td>
              <td class="td-number">{{ integral.acumulado_bold | currency:'USD':'$':'1.2-2' }}</td>
            </tr>
          </div>

          <tr class="fila-totales">
            <td class="columna-fija fija-clave texto-total">TOTALES</td>
            <td class="columna-fija fija-evac texto-total"></td>
            <td class="columna-fija fija-cliente texto-total"></td>

            <td class="td-number">{{ totales.acumulado_anticipado | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td></td>
            <td class="td-number">{{ totales.compra_minima_anual | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compra_minima_inicial | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_global | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_scott | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_global_scott | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_jul_ago | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_jul_ago | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_sep_oct | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_sep_oct | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_nov_dic | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_nov_dic | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>

            <td class="td-number">{{ totales.compromiso_ene_feb | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_ene_feb | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_mar_abr | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_mar_abr | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_may_jun | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_may_jun | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>

            <td class="td-number">{{ totales.compromiso_apparel_syncros_vittoria | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_global_apparel_syncros_vittoria | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_jul_ago_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_jul_ago_app | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_sep_oct_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_sep_oct_app | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_nov_dic_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_nov_dic_app | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>

            <td class="td-number">{{ totales.compromiso_ene_feb_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_ene_feb_app | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_mar_abr_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_mar_abr_app | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>
            <td class="td-number">{{ totales.compromiso_may_jun_app | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.avance_may_jun_app | currency:'USD':'$':'1.2-2' }}</td>
            <td></td>

            <td class="td-number">{{ totales.acumulado_syncros | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.acumulado_apparel | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.acumulado_vittoria | currency:'USD':'$':'1.2-2' }}</td>
            <td class="td-number">{{ totales.acumulado_bold | currency:'USD':'$':'1.2-2' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="paginador" *ngIf="totalPaginas > 1">
    <button (click)="cambiarPagina(1)" [disabled]="paginaActual === 1">« Primera</button>
    <button (click)="cambiarPagina(paginaActual - 1)" [disabled]="paginaActual === 1">‹ Anterior</button>
    <span class="paginador-info">
      Página
      <input type="number" min="1" [max]="totalPaginas" [(ngModel)]="paginaActualTemp"
        (keyup.enter)="cambiarPagina(paginaActualTemp)" />
      de {{ totalPaginas }}
    </span>
    <button (click)="cambiarPagina(paginaActual + 1)" [disabled]="paginaActual === totalPaginas">Siguiente ›</button>
    <button (click)="cambiarPagina(totalPaginas)" [disabled]="paginaActual === totalPaginas">Última »</button>
  </div>
</div>

<app-tooltip *ngIf="clienteParaTooltip" [cliente]="clienteParaTooltip" [position]="tooltipPosition">
</app-tooltip>