<div class="sort-dropdown" [class.show]="showDropdown">
  <button class="sort-btn" (click)="toggleDropdown($event)">
    <i class="fas fa-filter"></i>
    <span *ngIf="hasSelectedOptions" class="selected-text">
      {{ selectedLabel }}
    </span>
    <i class="fas fa-chevron-down"></i>
  </button>

  <div class="filter-options" [class.single-item]="filteredOptions.length === 1">
    <div class="filter-content-wrapper">
      <div class="filter-search">
        <input 
          type="text" 
          id="filterSearchInput" 
          name="filterSearchInput" 
          [(ngModel)]="searchTerm" 
          (input)="filterOptions()" 
          placeholder="Escribe aquÃ­"
          (click)="$event.stopPropagation()"
          (keydown.enter)="applyFilter()">
      </div>
      
      <div class="filter-items-container">
        <div *ngIf="filteredOptions.length === 0" class="no-selections">
          {{ searchTerm ? 'No se encontraron resultados' : 'No hay elementos seleccionados' }}
        </div>
        
        <div *ngFor="let option of filteredOptions" class="filter-item">
          <label [for]="'filterOption_' + option.value">
            <input 
              type="checkbox" 
              [id]="'filterOption_' + option.value" 
              [name]="'filterOption_' + option.value" 
              [(ngModel)]="option.selected"
              (change)="onSelectionChange()"
              (click)="$event.stopPropagation()">
            {{ option.value }}
          </label>
        </div>
      </div>
      
      <div class="filter-actions">
        <button (click)="clearFilter(); $event.stopPropagation()">Limpiar</button>
        <button (click)="applyFilter(); $event.stopPropagation()">Aplicar</button>
      </div>
    </div>
  </div>
</div>